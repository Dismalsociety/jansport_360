# SECTION 12 : Denormalize to get actual pressure values
pressure_mean = scaler.mean_[1]
pressure_std = scaler.scale_[1]

predictions_actual = predictions_array * pressure_std + pressure_mean
targets_actual = targets_array * pressure_std + pressure_mean


# Calculate fidelity score
errors = np.abs(predictions_actual - targets_actual)
mean_error = np.mean(errors)
max_pressure = np.max(targets_actual)
min_pressure = np.min(targets_actual)
pressure_range = max_pressure - min_pressure

fidelity_score = (1 - mean_error / pressure_range) * 100
fidelity_score = max(0, min(100, fidelity_score)) 

print(f"Fidelity: {fidelity_score:.1f}%")



# Calculate Fidelity Score
correlation = np.corrcoef(predictions_actual.flatten(), targets_actual.flatten())[0, 1]
fidelity_score = correlation * 100

print(f"Fidelity Score: {fidelity_score:.1f}%")
